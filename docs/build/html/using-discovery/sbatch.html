<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using sbatch &mdash; Northeastern University Research Computing 2.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/../css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using srun" href="srun.html" />
    <link rel="prev" title="Using Slurm" href="usingslurm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/NU_logo_small.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Welcome</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../welcome/welcome.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../welcome/gettinghelp.html">Getting Help</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started with Discovery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/get_access.html">Getting Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/connect.html">Connecting to Discovery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware on Discovery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware_overview.html">Hardware overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/partitions.html">Partitions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software on Discovery</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../software/softwareoverview.html">Software overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/modules.html">Using Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/matlab.html">Working with MATLAB on Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/conda.html">Working with Conda/Miniconda/Anaconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/spack.html">Using Spack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/r.html">Working with R</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/mpi.html">Message Passing Interface (MPI) Overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Discovery</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usingslurm.html">Using Slurm</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using sbatch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#sbatch-examples">SBATCH Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#job-requesting-one-node">Job requesting one node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#job-requesting-one-node-and-additional-memory">Job requesting one node and additional memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#job-requesting-one-node-with-exclusive-use-of-a-node">Job requesting one node with exclusive use of a node</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-parallel-job-scripts">Example Parallel Job Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-job-one-node-and-additional-memory">8-task job, one node and additional memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-job-multiple-nodes-and-additional-memory">8-task job, multiple nodes and additional memory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-arrays">Using Arrays</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="srun.html">Using srun</a></li>
<li class="toctree-l1"><a class="reference internal" href="workingwithgpu.html">Working with GPUs</a></li>
<li class="toctree-l1"><a class="reference internal" href="transferringdata.html">Transferring Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="globus.html">Using Globus</a></li>
<li class="toctree-l1"><a class="reference internal" href="bashrc.html">Working with your bashrc file</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Understanding storage options</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../storage/discovery_storage.html">Storage Accessible on  Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../storage/general_storage.html">General Data Storage Options</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Open OnDemand (OOD)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using-ood/introduction.html">Introduction to Open OnDemand (OOD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-ood/fileexplore.html">Using OOD’s File Explorer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-ood/interactiveapps.html">Using OOD’s Interactive Apps</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Discovery in your classroom</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../classroom/class_use.html">Using Discovery with your class FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Northeastern University Research Computing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Using sbatch</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-sbatch">
<span id="id1"></span><h1>Using sbatch<a class="headerlink" href="#using-sbatch" title="Permalink to this headline"></a></h1>
<p>You use the <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> command with a bash script to specify the
resources you need to run your jobs, such as the number of nodes you want to run your jobs
on and how much memory you’ll need. Slurm then schedules your job based on the
availability of the resources you’ve specified.
The general format for submitting a job to the scheduler is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sbatch</span> <span class="n">example</span><span class="o">.</span><span class="n">script</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">example.script</span></code> is a script detailing the parameters of the job you want to run.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default time limit depends on the partition that you specify in your submission script using the
<code class="docutils literal notranslate"><span class="pre">--partition=&lt;partition</span> <span class="pre">name&gt;</span></code> option.
If your job does not complete within the requested time limit,
Slurm will automatically terminate the job.
See <a class="reference internal" href="../hardware/partitions.html#partition-names"><span class="std std-ref">Partitions</span></a> for the most up-to-date partition names and parameters.</p>
</div>
<section id="sbatch-examples">
<h2>SBATCH Examples<a class="headerlink" href="#sbatch-examples" title="Permalink to this headline"></a></h2>
<section id="job-requesting-one-node">
<h3>Job requesting one node<a class="headerlink" href="#job-requesting-one-node" title="Permalink to this headline"></a></h3>
<p>Run a job on one node for 4 hours on the short partition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="job-requesting-one-node-and-additional-memory">
<h3>Job requesting one node and additional memory<a class="headerlink" href="#job-requesting-one-node-and-additional-memory" title="Permalink to this headline"></a></h3>
<p>The default memory per allocated core is 1GB. If your calculations try to use
more memory than what is allocated, Slurm automatically terminates your job.
You should request a specific amount of memory in your job script if your
calculations need more memory than the default. The example script below is
requesting 100GB of memory (–mem=100G). Use one capital letter to abbreviate
the unit of memory (K,M,G,T) with the <code class="docutils literal notranslate"><span class="pre">--mem=</span></code> option, as that is what Slurm expects to see.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --mem=100G</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="job-requesting-one-node-with-exclusive-use-of-a-node">
<h3>Job requesting one node with exclusive use of a node<a class="headerlink" href="#job-requesting-one-node-with-exclusive-use-of-a-node" title="Permalink to this headline"></a></h3>
<p>If you need exclusive use of a node, such as when you have a job that has high
I/O requirements, you can use the exclusive flag. The example script below
specifies exclusive use of 1 node in the short partition for four hours.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --exclusive</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="example-parallel-job-scripts">
<h2>Example Parallel Job Scripts<a class="headerlink" href="#example-parallel-job-scripts" title="Permalink to this headline"></a></h2>
<p>Parallel jobs should be used with code that is configured to use the reserved resources.
If your code is not optimized for running in parallel, your job could fail.
The following script examples all allocate additional memory.
The default memory per allocated core is 1GB. If your calculations try to use more
memory than what is allocated, Slurm automatically terminates your job.
You should request a specific amount of memory in your job script if your calculations
need more memory than the default.</p>
<section id="task-job-one-node-and-additional-memory">
<h3>8-task job, one node and additional memory<a class="headerlink" href="#task-job-one-node-and-additional-memory" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=1</span>
<span class="c1">#SBATCH --ntasks-per-node=8</span>
<span class="c1">#SBATCH --cpus-per-task=1</span>
<span class="c1">#SBATCH --time=4:00:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --mem=100G</span>
<span class="c1">#SBATCH --partition=short</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="task-job-multiple-nodes-and-additional-memory">
<h3>8-task job, multiple nodes and additional memory<a class="headerlink" href="#task-job-multiple-nodes-and-additional-memory" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --nodes=4</span>
<span class="c1">#SBATCH --ntasks-per-node=2</span>
<span class="c1">#SBATCH --cpus-per-task=1</span>
<span class="c1">#SBATCH --time=00:30:00</span>
<span class="c1">#SBATCH --job-name=MyJobName</span>
<span class="c1">#SBATCH --mem=100G</span>
<span class="c1">#SBATCH --partition=express</span>
<span class="o">&lt;</span><span class="n">commands</span> <span class="n">to</span> <span class="n">execute</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="using-arrays">
<h2>Using Arrays<a class="headerlink" href="#using-arrays" title="Permalink to this headline"></a></h2>
<p>Using a job array can often help in situations where you need to submit multiple similar jobs.
To use an array with your jobs, in your <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> script, use the <code class="docutils literal notranslate"><span class="pre">array=</span></code> option.</p>
<p>For example, if you want to run a 10 job array, one job at a time, you would add the following
line to your sbatch script:</p>
<p><code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--array=1-10%1</span></code></p>
<p>For more information on this command, go to the  <a class="reference external" href="https://slurm.schedmd.com/job_array.html">Slurm documentation page</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usingslurm.html" class="btn btn-neutral float-left" title="Using Slurm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="srun.html" class="btn btn-neutral float-right" title="Using srun" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Northeastern University Research Computing.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>